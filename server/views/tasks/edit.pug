extends ../layouts/application.pug

block header
  = t('views.tasks.edit')

block content
  +formFor()(action=`/tasks/${task.id}` method='post')
    input(type='hidden' name='_method' value='patch')
    +input(task, 'name', errors)(type="text")
    +input(task, 'description', errors)(type="text")
    
    .mb-3(class=(errors && errors.statusId && 'has-danger'))
      label.form-label(for="data_statusId")= t('views.tasks.status')
      select.form-control(
        id="data_statusId"
        name="data[statusId]"
        class=(errors && errors.statusId ? 'is-invalid' : '')
      )
        option(value="")= t('views.tasks.selectStatus')
        each status in statuses
          option(
            value=status.id
            selected=(task.statusId == status.id)
          )= status.name
      if errors && errors.statusId
        .invalid-feedback= errors.statusId.map(({ message }) => message).join('. ')
    
    .mb-3(class=(errors && errors.executorId && 'has-danger'))
      label.form-label(for="data_executorId")= t('views.tasks.executor')
      select.form-control(
        id="data_executorId"
        name="data[executorId]"
        class=(errors && errors.executorId ? 'is-invalid' : '')
      )
        option(value="")= t('views.tasks.selectExecutor')
        each user in users
          option(
            value=user.id
            selected=(task.executorId == user.id)
          )= user.firstName + ' ' + user.lastName
      if errors && errors.executorId
        .invalid-feedback= errors.executorId.map(({ message }) => message).join('. ')
    
    .mb-3
      label.form-label(for="labelIds")= t('views.tasks.labels')
      select.form-control(
        id="labelIds"
        name="labelIds"
        multiple
      )
        each label in labels
          option(
            value=label.id
            selected=(task.labels && task.labels.some(l => l.id === label.id))
          )= label.name
    
    +submit(task)(value=t('views.tasks.submit'))
